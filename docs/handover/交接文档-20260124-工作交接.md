# OpenSkills å·¥ä½œäº¤æ¥æ–‡æ¡£

**åˆ›å»ºæ—¶é—´**: 2026-01-24  
**é¡¹ç›®çŠ¶æ€**: å¼€å‘ç¯å¢ƒå·²é…ç½®ï¼Œä¸»è¦åŠŸèƒ½å·²ä¿®å¤å¹¶æµ‹è¯•é€šè¿‡

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

OpenSkills æ˜¯ä¸€ä¸ª AI Skills è‡ªè¿›åŒ–ç®¡ç†å·¥å…·ï¼ŒåŒ…å«ï¼š
- **API æœåŠ¡** (Express.js) - ç«¯å£ 3000
- **Web ç•Œé¢** (React + Vite) - é»˜è®¤ç«¯å£ 3848ï¼ˆå¯ç”±é…ç½®/ç¯å¢ƒå˜é‡ VITE_PORT å†³å®šï¼‰
- **VS Code/Cursor æ‰©å±•** - æä¾› IDE é›†æˆ

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é¡¹ç›®å¯åŠ¨é…ç½®

#### Docker ç¯å¢ƒé…ç½®
- **æ–‡ä»¶**: `docker-compose.dev.yml`
- **ä¿®æ”¹å†…å®¹**:
  - æ·»åŠ  `WORKSPACE_ROOT=/app` ç¯å¢ƒå˜é‡åˆ° `api` æœåŠ¡
  - ä¿®æ”¹ `VITE_API_URL=http://api:3000` ç”¨äºå®¹å™¨é—´é€šä¿¡
- **å¯åŠ¨å‘½ä»¤**:
  ```bash
  docker-compose -f docker-compose.dev.yml up -d
  ```

#### Vite ä»£ç†é…ç½®
- **æ–‡ä»¶**: `packages/web/vite.config.ts`
- **ä¿®æ”¹**: ä½¿ç”¨ç¯å¢ƒå˜é‡ `process.env.VITE_API_URL` åŠ¨æ€é…ç½®ä»£ç†ç›®æ ‡
- **ä½œç”¨**: æ”¯æŒ Docker å®¹å™¨é—´é€šä¿¡

#### API æœåŠ¡é…ç½®
- **æ–‡ä»¶**: `packages/api/src/index.ts`
- **ä¿®æ”¹**: é»˜è®¤ `HOST` ä» `'localhost'` æ”¹ä¸º `'0.0.0.0'`
- **ä½œç”¨**: å…è®¸ API æœåŠ¡æ¥å—æ¥è‡ªå…¶ä»– Docker å®¹å™¨çš„è¿æ¥

---

### 2. ä¿®å¤çš„ BUG åˆ—è¡¨

#### BUG 1: Vite ä»£ç†é…ç½®é”™è¯¯
- **é—®é¢˜**: Web å®¹å™¨æ— æ³•è¿æ¥åˆ° API å®¹å™¨ï¼Œè¿”å› `ECONNREFUSED`
- **åŸå› **: Vite ä»£ç†ç›®æ ‡ç¡¬ç¼–ç ä¸º `localhost:3000`
- **ä¿®å¤**: ä½¿ç”¨ç¯å¢ƒå˜é‡ `VITE_API_URL` åŠ¨æ€é…ç½®
- **æ–‡ä»¶**: `packages/web/vite.config.ts`, `docker-compose.dev.yml`

#### BUG 2: Button ç»„ä»¶ asChild å’Œ loading å†²çª
- **é—®é¢˜**: ä½¿ç”¨ `asChild={true}` å’Œ `loading` æ—¶å‡ºç° React `Children.only` é”™è¯¯
- **åŸå› **: `@radix-ui/react-slot` çš„ `Slot` ç»„ä»¶åªèƒ½æ¥æ”¶å•ä¸ªå­å…ƒç´ 
- **ä¿®å¤**: åœ¨ `asChild` æ¨¡å¼ä¸‹ä¸æ¸²æŸ“ loading å›¾æ ‡
- **æ–‡ä»¶**: `packages/web/src/components/ui/Button.tsx`

#### BUG 3: API æœåŠ¡ç›‘å¬åœ°å€é”™è¯¯
- **é—®é¢˜**: API æœåŠ¡åªç›‘å¬ `localhost`ï¼Œå…¶ä»–å®¹å™¨æ— æ³•è¿æ¥
- **ä¿®å¤**: é»˜è®¤ `HOST` æ”¹ä¸º `'0.0.0.0'`
- **æ–‡ä»¶**: `packages/api/src/index.ts`

#### BUG 4: ç¼ºå°‘ API è·¯ç”±
- **é—®é¢˜**: å‰ç«¯æ”¶åˆ° 404 é”™è¯¯ï¼ˆ`/api/config`, `/api/preferences`, `/api/skills`, `/api/admin/status`, `/api/admin/wake-history`ï¼‰
- **ä¿®å¤**:
  - æ³¨å†Œ `createConfigRouter` å’Œ `createPreferencesRouter`
  - æ·»åŠ ç®€å•çš„å†…è”è·¯ç”±å¤„ç† `/api/skills`, `/api/admin/status`, `/api/admin/wake-history`
- **æ–‡ä»¶**: `packages/api/src/index.ts`

#### BUG 5: Dashboard å’Œ AdminPanel ç©ºæŒ‡é’ˆé”™è¯¯
- **é—®é¢˜**: `TypeError: Cannot read properties of null (reading 'nextRun')`
- **åŸå› **: `schedulerStatus.wake` æˆ– `schedulerStatus.crawl` å¯èƒ½ä¸º `null`
- **ä¿®å¤**:
  - Dashboard: æ·»åŠ  `schedulerStatus?.wake?.nextRun`ï¼ˆåŒé‡å¯é€‰é“¾ï¼‰
  - AdminPanel: æ£€æŸ¥ `schedulerStatus?.crawl && schedulerStatus?.wake` å­˜åœ¨æ€§
- **æ–‡ä»¶**: `packages/web/src/pages/Dashboard.tsx`, `packages/web/src/components/admin/AdminPanel.tsx`

#### BUG 6: API Client æ•°æ®è§£æé”™è¯¯
- **é—®é¢˜**: Config å’Œ Preferences é¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œæ§åˆ¶å°æŠ¥é”™
- **åŸå› **: API è¿”å› `{ merged: Config, sources: {...} }`ï¼Œä½†å‰ç«¯æœŸæœ›ç›´æ¥ `Config`
- **ä¿®å¤**: åœ¨ `getConfig()` å’Œ `getPreferences()` ä¸­æå– `merged` å±æ€§
- **æ–‡ä»¶**: `packages/web/src/api/index.ts`

#### BUG 7: triggerWake API è·¯å¾„é”™è¯¯
- **é—®é¢˜**: "æ— æ³•å”¤é†’ç®¡ç†å‘˜" - API è¿”å› 404
- **åŸå› **: å‰ç«¯è°ƒç”¨ `/scheduler/wake`ï¼Œä½† API ç«¯ç‚¹æ˜¯ `/scheduler/wake/trigger`
- **ä¿®å¤**: æ›´æ–° API å®¢æˆ·ç«¯è·¯å¾„
- **æ–‡ä»¶**: `packages/web/src/api/index.ts`

#### BUG 8: Config ä¿å­˜å¤±è´¥
- **é—®é¢˜**: ä¿å­˜é…ç½®æ—¶æ˜¾ç¤º"ä¿å­˜å¤±è´¥"
- **åŸå› **: API åªæœ‰ `PUT` æ–¹æ³•ï¼Œä½†å‰ç«¯ä½¿ç”¨ `PATCH`
- **ä¿®å¤**: åœ¨ `config.ts` å’Œ `preferences.ts` ä¸­æ·»åŠ  `PATCH` æ–¹æ³•
- **æ–‡ä»¶**: `packages/api/src/routes/config.ts`, `packages/api/src/routes/preferences.ts`

#### BUG 9: Crawler é¡µé¢ç©ºç™½
- **é—®é¢˜**: Crawler é¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œæ§åˆ¶å°æŠ¥é”™ `Cannot read properties of undefined (reading 'icon')`
- **åŸå› **: API è¿”å›çš„æ•°æ®æ ¼å¼ä¸å‰ç«¯æœŸæœ›ä¸åŒ¹é…
  - API: `runId`, `stats.reposSearched`
  - å‰ç«¯æœŸæœ›: `id`, `status`, `reposScanned`
- **ä¿®å¤**: åœ¨ `/api/crawler/runs` å’Œ `/api/crawler/repos` ç«¯ç‚¹ä¸­è½¬æ¢æ•°æ®æ ¼å¼
- **æ–‡ä»¶**: `packages/api/src/routes/crawler.ts`

#### BUG 10: Scheduler çŠ¶æ€æ˜¾ç¤ºé”™è¯¯
- **é—®é¢˜**: Wake è°ƒåº¦å™¨æ˜¾ç¤º"å·²ç¦ç”¨"ï¼Œä½†é…ç½®ä¸­å·²å¯ç”¨
- **åŸå› **: API è¿”å› `active` å±æ€§ï¼Œä½†å‰ç«¯æœŸæœ› `enabled`
- **ä¿®å¤**: åœ¨ `wakeScheduler.ts` å’Œ `crawlScheduler.ts` çš„ `getStatus()` ä¸­æ·»åŠ  `enabled`, `nextRun`, `lastRun` å±æ€§
- **æ–‡ä»¶**: `packages/api/src/scheduler/wakeScheduler.ts`, `packages/api/src/scheduler/crawlScheduler.ts`

---

### 3. é…ç½®æ›´æ”¹

#### é»˜è®¤é…ç½®æ–‡ä»¶
- **æ–‡ä»¶**: `.openskills/config.json`
- **å½“å‰é…ç½®**:
  ```json
  {
    "adminMode": "agent_only",
    "crawl": {
      "enabled": true,
      "schedule": "*/10 * * * *",
      "topics": ["cursor-skills", "skills"]
    },
    "wake": {
      "enabled": true,
      "schedule": "*/5 * * * *"
    }
  }
  ```

#### Docker ç¯å¢ƒå˜é‡
- `WORKSPACE_ROOT=/app` - API æœåŠ¡å·¥ä½œåŒºæ ¹ç›®å½•
- `VITE_API_URL=http://api:3000` - Web æœåŠ¡ API ä»£ç†åœ°å€

---

### 4. æ‰©å±•å¼€å‘é…ç½®

#### launch.json é…ç½®
- **æ–‡ä»¶**: `.vscode/launch.json`
- **å½“å‰é…ç½®**: æ–°çª—å£æ‰“å¼€ `packages/extension` å­ç›®å½•ï¼ˆé¿å…çª—å£åˆå¹¶ï¼‰
- **æ³¨æ„**: VS Code/Cursor çš„æ‰©å±•å¼€å‘æ¨¡å¼å¿…é¡»æ‰“å¼€æ–°çª—å£ï¼Œè¿™æ˜¯æ¶æ„é™åˆ¶

#### è·¯å¾„æŸ¥æ‰¾ä¼˜åŒ–
- **æ–‡ä»¶**: `packages/extension/src/utils/paths.ts`
- **ä¿®æ”¹**: `getWorkspaceRoot()` å‡½æ•°å‘ä¸ŠæŸ¥æ‰¾åŒ…å« `.openskills` çš„é¡¹ç›®æ ¹ç›®å½•
- **ä½œç”¨**: å³ä½¿æ–°çª—å£æ‰“å¼€å­ç›®å½•ï¼Œæ‰©å±•ä¹Ÿèƒ½æ­£ç¡®æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•

---

## ğŸ§ª æµ‹è¯•çŠ¶æ€

### å·²æµ‹è¯•é¡µé¢ï¼ˆå…¨éƒ¨é€šè¿‡ï¼‰
- âœ… Dashboard - æ­£å¸¸æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
- âœ… Skills - æ­£å¸¸æ˜¾ç¤º Skills åˆ—è¡¨
- âœ… Proposals - æ­£å¸¸æ˜¾ç¤ºæè®®åˆ—è¡¨
- âœ… Decisions - æ­£å¸¸æ˜¾ç¤ºå†³ç­–å†å²
- âœ… Crawler - æ­£å¸¸æ˜¾ç¤ºè¿è¡Œè®°å½•å’Œç¼“å­˜ä»“åº“
- âœ… Admin - æ­£å¸¸æ˜¾ç¤ºè°ƒåº¦å™¨çŠ¶æ€å’Œå”¤é†’å†å²
- âœ… Preferences - æ­£å¸¸æ˜¾ç¤ºå’Œä¿å­˜åå¥½è®¾ç½®
- âœ… Config - æ­£å¸¸æ˜¾ç¤ºå’Œä¿å­˜é…ç½®

### API ç«¯ç‚¹æµ‹è¯•
- âœ… `/api/config` (GET, PATCH) - æ­£å¸¸
- âœ… `/api/preferences` (GET, PATCH) - æ­£å¸¸
- âœ… `/api/skills` - æ­£å¸¸
- âœ… `/api/admin/status` - æ­£å¸¸
- âœ… `/api/admin/wake-history` - æ­£å¸¸
- âœ… `/api/scheduler/status` - æ­£å¸¸
- âœ… `/api/scheduler/wake/trigger` - æ­£å¸¸
- âœ… `/api/crawler/runs` - æ­£å¸¸
- âœ… `/api/crawler/repos` - æ­£å¸¸

---

## ğŸš€ å¯åŠ¨æµç¨‹

### 1. å¯åŠ¨ Docker æœåŠ¡
```bash
docker-compose -f docker-compose.dev.yml up -d
```

### 2. éªŒè¯æœåŠ¡
- API: å®é™… API åœ°å€/healthï¼ˆç«¯å£ç”± PORT æˆ–é…ç½®å†³å®šï¼‰
- Web: å®é™… Web åœ°å€ï¼ˆé»˜è®¤ 3848ï¼‰

### 3. å¯åŠ¨æ‰©å±•ï¼ˆå¯é€‰ï¼‰
- æŒ‰ `F5` å¯åŠ¨æ‰©å±•å¼€å‘æ¨¡å¼
- æ–°çª—å£ä¼šæ‰“å¼€ `packages/extension` ç›®å½•
- å·¦ä¸‹è§’ä¼šæ˜¾ç¤º OpenSkills çŠ¶æ€æ 

---

## ğŸ“ å…³é”®æ–‡ä»¶ä½ç½®

### é…ç½®æ–‡ä»¶
- `.openskills/config.json` - é¡¹ç›®çº§é…ç½®
- `docker-compose.dev.yml` - Docker å¼€å‘ç¯å¢ƒé…ç½®

### å‰ç«¯ä»£ç 
- `packages/web/src/` - React å‰ç«¯ä»£ç 
- `packages/web/vite.config.ts` - Vite é…ç½®

### åç«¯ä»£ç 
- `packages/api/src/index.ts` - API å…¥å£
- `packages/api/src/routes/` - API è·¯ç”±
- `packages/api/src/scheduler/` - è°ƒåº¦å™¨ä»£ç 

### æ‰©å±•ä»£ç 
- `packages/extension/src/` - æ‰©å±•æºä»£ç 
- `packages/extension/out/` - ç¼–è¯‘åçš„æ‰©å±•ä»£ç 

---

## âš ï¸ å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

### 1. VS Code æ‰©å±•çª—å£åˆå¹¶
- **é—®é¢˜**: å½“ä¸¤ä¸ªçª—å£æ‰“å¼€åŒä¸€å·¥ä½œåŒºæ—¶ï¼ŒVS Code ä¼šè‡ªåŠ¨åˆå¹¶çª—å£
- **å½“å‰æ–¹æ¡ˆ**: æ–°çª—å£æ‰“å¼€ `packages/extension` å­ç›®å½•ï¼Œæ‰©å±•ä»£ç è‡ªåŠ¨å‘ä¸ŠæŸ¥æ‰¾é¡¹ç›®æ ¹ç›®å½•
- **çŠ¶æ€**: å·²å®ç°ï¼Œä½†éœ€è¦æµ‹è¯•éªŒè¯

### 2. Crawler æ‰«æç»“æœä¸º 0
- **åŸå› **:
  - æ—  GitHub Tokenï¼ŒAPI é€Ÿç‡é™åˆ¶åªæœ‰ 60 è¯·æ±‚/å°æ—¶
  - æœç´¢æ¡ä»¶ä¸¥æ ¼ï¼ˆtopic `cursor-skills` + minStars 100ï¼‰
- **è§£å†³æ–¹æ¡ˆ**: åœ¨ Config é¡µé¢é…ç½® GitHub Token

### 3. æ‰©å±•æ‰“åŒ…æƒé™é—®é¢˜
- **é—®é¢˜**: æ‰“åŒ… VSIX æ–‡ä»¶æ—¶é‡åˆ°æƒé™é”™è¯¯
- **çŠ¶æ€**: æœªè§£å†³ï¼Œå»ºè®®ä½¿ç”¨ F5 å¼€å‘æ¨¡å¼

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### Docker æ“ä½œ
```bash
# å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.dev.yml up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.dev.yml logs -f

# é‡å¯æœåŠ¡
docker restart openskills-api-dev openskills-web-dev

# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.dev.yml down
```

### æ‰©å±•å¼€å‘
```bash
# ç¼–è¯‘æ‰©å±•
cd packages/extension
npm run compile

# ç›‘å¬æ¨¡å¼ç¼–è¯‘
npm run watch
```

### API æµ‹è¯•
```powershell
# å¥åº·æ£€æŸ¥
Invoke-WebRequest -Uri "http://localhost:3000/health"

# æ£€æŸ¥ Scheduler çŠ¶æ€
Invoke-WebRequest -Uri "http://localhost:3000/api/scheduler/status"
```

---

## ğŸ“ å¾…åŠäº‹é¡¹

1. **æ‰©å±•çª—å£åˆå¹¶é—®é¢˜** - éœ€è¦éªŒè¯æ–°é…ç½®æ˜¯å¦æœ‰æ•ˆ
2. **VSIX æ‰“åŒ…** - è§£å†³æƒé™é—®é¢˜ï¼Œç”Ÿæˆå¯å®‰è£…çš„æ‰©å±•åŒ…
3. **GitHub Token é…ç½®** - åœ¨ Config é¡µé¢æ·»åŠ  Token é…ç½®è¯´æ˜
4. **Crawler ä¼˜åŒ–** - ä¼˜åŒ–æœç´¢æ¡ä»¶æˆ–æ·»åŠ æ›´å¤š topics
5. **é”™è¯¯å¤„ç†** - æ”¹è¿›å‰ç«¯é”™è¯¯æç¤ºå’Œ API é”™è¯¯å“åº”

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **æµ‹è¯•æ‰©å±•åŠŸèƒ½**
   - æŒ‰ F5 å¯åŠ¨æ‰©å±•
   - éªŒè¯çŠ¶æ€æ æ˜¾ç¤º
   - æµ‹è¯•ä¾§è¾¹æ è§†å›¾

2. **é…ç½® GitHub Token**
   - åœ¨ Config é¡µé¢æ·»åŠ  GitHub Token
   - æµ‹è¯• Crawler åŠŸèƒ½

3. **å®Œå–„æ–‡æ¡£**
   - æ›´æ–° README.md
   - æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Docker æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
2. API æ—¥å¿—ï¼š`docker logs openskills-api-dev`
3. Web æ—¥å¿—ï¼š`docker logs openskills-web-dev`
4. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2026-01-24
